

<!DOCTYPE HTML>
<!--
	Solid State by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Peter Ritchie&#x27;s Blog - Fundamentals of OOD, Part 2 &#x2013; Encapsulation Scope</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="/assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="/assets/sass/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="/assets/sass/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="/assets/sass/ie8.css" /><![endif]-->
        

	</head>
	<body>

		<!-- Page Wrapper -->
			<div id="page-wrapper">
				
				<!-- Header -->
				<header id="header">
					<h1><a href="/">Peter Ritchie&#x27;s Blog</a></h1>
					<nav>
						<a href="#menu">Menu</a>
					</nav>
				</header>

				<!-- Menu -->
				<nav id="menu">
					<div class="inner">
						<h2>Menu</h2>
						<ul class="links">
							        <li><a href="/posts">Archive</a></li>
        <li><a href="/tags">Tags</a></li>
        <li><a href="/about">About</a></li>

						</ul>
						<a href="#" class="close">Close</a>
					</div>
				</nav>


    
<section id="banner">
  <div class="inner">
    <h2>Fundamentals of OOD, Part 2 &#x2013; Encapsulation Scope</h2>
            <p><em>Published on Thursday, May 8, 2008</em></p>
                    <a role="button" href="/tags/C%23" class="button small">C#</a>
                <a role="button" href="/tags/Design/Coding-Guidance" class="button small">Design/Coding Guidance</a>
                <a role="button" href="/tags/DevCenterPost" class="button small">DevCenterPost</a>
                <a role="button" href="/tags/May-2008" class="button small">May 2008</a>
                <a role="button" href="/tags/msmvps" class="button small">msmvps</a>
                <a role="button" href="/tags/Software-Development" class="button small">Software Development</a>
  </div>
</section>

				<!-- Main -->
				<section id="wrapper">
					<section class="wrapper style2">
						<div class="inner">
							

<p><a href="http://blogs.msmvps.com/peterritchie/2008/05/08/fundamentals-of-ood-part-2-encapsulation-scope/" title="Permalink to Fundamentals of OOD, Part 2 – Encapsulation Scope">Source</a></p>
<h1 id="fundamentals-of-ood-part-2-encapsulation-scope">Fundamentals of OOD, Part 2 – Encapsulation Scope</h1>
<p>Let's look at the ubiquitous Person concept. It might seem logical that an application that deals with people should have a Person interface for classes to implement. For example:</p>
<p>public interface IPerson<br />
{<br />
String GivenName { get; set; }<br />
String SurName { get; set; }<br />
IAddress Address { get; set; }<br />
}</p>
<p>At first glance this seems fine. The IPerson interface defines attributes that the application uses with most scenarios dealing with types of IPerson, it's &quot;well encapsulated&quot;. But, the person concept is much more broad than what IPerson is modeling. IPerson hasn't fully encapsulated the person concept. A person could have parents, age, weight, height, etc. The application doesn't need this information so it's narrowed the concept of person to fit its needs. This is an incomplete abstraction. The type that the application needs (that is currently IPerson) should be fully abstract. Based on the IPerson interface, a better abstraction would be ILocatableIndividual.</p>
<p>Let's look at the opposite of not fully encapsulating a concept.</p>
<p>Let's look at another common concept, the Invoice:</p>
<p>public class Invoice<br />
{<br />
Customer BillToCustomer { get;set; }<br />
Customer ShipToCustomer { get;set; }<br />
Datetime InvoiceDate;<br />
ICollection<InvoiceItem> InvoiceItems { get; }<br />
Single ShippingAndHandlingPrice { get; set; }<br />
Single CalculateSubTotal();<br />
Single CalculateTotal();<br />
Single CalculateGrandTotal();<br />
PurchaseOrder PurchaseOrder { get; set; }<br />
void Print();<br />
}</p>
<p>Again, seems like a reasonable encapsulation; but it has an issue.</p>
<p>There's a fundamental principle of OOD called the Single Responsibility Principle. Robert Martin interprets the principle as &quot;there should never be more than one reason for a class to change.&quot;. A class should model a single abstraction. For that abstraction to remain abstract the modeled class should have a single responsibility. In the case of Invoice, the invoice concept should only model behaviours and attributes of an invoice. An invoice does not print, something or someone else prints it. With the above Invoice definition should printing need to change Invoice must also change, event though what the invoice <em>is</em> doesn't change. Invoice is now coupled to how printing occurs. In Martin's terms, Invoice now has two reasons for it to change: when invoice attributes change, and when how printing occurs changes.</p>
<p>The Invoice class should be refactored by moving the Print method to another class. Likely this would involve MVC, or MVP where a view would be responsible for the &quot;printed view&quot; and a controller or presenter would be responsible for communicating with the model (Invoice).</p>
<p><img src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=http%3a%2f%2fmsmvps.com%2fblogs%2fpeterritchie%2farchive%2f2008%2f05%2f08%2ffundamentals-of-ood-part-2-encapsulation-scope.aspx" class="img-fluid" alt="kick it on DotNetKicks.com" /></p>


<div id="disqus_thread"></div>  
<!--
    'Fundamentals-of-OOD%2C-Part-2-%E2%80%93-Encapsulation-Scope'
    'Fundamentals of OOD, Part 2 &#x2013; Encapsulation Scope'
    'http://blog.peterritchie.com/posts/Fundamentals-of-OOD%2C-Part-2-%E2%80%93-Encapsulation-Scope'
-->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */

    var fromJekyllDate = new Date('Wed Feb 01 2022');
    var publishedDate = new Date('5/8/2008');
    console.info('Fundamentals-of-OOD%2C-Part-2-%E2%80%93-Encapsulation-Scope');

    var disqus_identifier = '';
    var disqus_shortname = 'peterritchiesblog'; // required: replace example with your forum shortname
    var disqus_title = 'Fundamentals of OOD, Part 2 &#x2013; Encapsulation Scope';
    var disqus_url = 'http://blog.peterritchie.com/posts/Fundamentals-of-OOD%2C-Part-2-%E2%80%93-Encapsulation-Scope';

    if(publishedDate < fromJekyllDate)
    {
        disqus_url = disqus_url.replace('/posts', '');
        disqus_url = disqus_url + '/';
    }
    else
    {
        //var disqus_identifier = 'Fundamentals-of-OOD%2C-Part-2-%E2%80%93-Encapsulation-Scope';
    }
    console.info(disqus_identifier);

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
						</div>
					</section>
				
				</section>
				
				<!-- Footer -->
                <footer id="footer">
                    <div class="container">
        <div class="row">
                <div class="col-md-12 text-center">
                    <p class="copyright text-muted">
                        Copyright © Peter Ritchie&#x27;s Blog 2022
                        <br />
                            <a href="/feed.xml"><i class="fa fa-rss"></i> RSS Feed</a>
                        |
                            <a href="/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
                        <br />
                        <strong><a href="https://wyam.io">Generated by "Wyam"</a></strong>
                    </p>
                </div>
        </div>
</div>
                </footer>
			</div>

		<!-- Scripts -->
			<script src="/assets/js/skel.min.js"></script>
			<script src="/assets/js/jquery.min.js"></script>
			<script src="/assets/js/jquery.scrollex.min.js"></script>
			<script src="/assets/js/util.js"></script>
            <!--[if lte IE 8]><script src="/assets/js/ie/respond.min.js"></script><![endif]-->
            <script src="/assets/js/main.js"></script>

	</body>

</html>