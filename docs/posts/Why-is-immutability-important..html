

<!DOCTYPE HTML>
<!--
	Solid State by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Peter Ritchie&#x27;s Blog - Why is immutability important.</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="/assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="/assets/sass/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="/assets/sass/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="/assets/sass/ie8.css" /><![endif]-->
        

	</head>
	<body>

		<!-- Page Wrapper -->
			<div id="page-wrapper">
				
				<!-- Header -->
				<header id="header">
					<h1><a href="/">Peter Ritchie&#x27;s Blog</a></h1>
					<nav>
						<a href="#menu">Menu</a>
					</nav>
				</header>

				<!-- Menu -->
				<nav id="menu">
					<div class="inner">
						<h2>Menu</h2>
						<ul class="links">
							        <li><a href="/posts">Archive</a></li>
        <li><a href="/tags">Tags</a></li>
        <li><a href="/about">About</a></li>

						</ul>
						<a href="#" class="close">Close</a>
					</div>
				</nav>


    
<section id="banner">
  <div class="inner">
    <h2>Why is immutability important.</h2>
            <p><em>Published on Monday, January 7, 2008</em></p>
                    <a role="button" href="/tags/January-2008" class="button small">January 2008</a>
                <a role="button" href="/tags/msmvps" class="button small">msmvps</a>
                <a role="button" href="/tags/Uncategorized" class="button small">Uncategorized</a>
  </div>
</section>

				<!-- Main -->
				<section id="wrapper">
					<section class="wrapper style2">
						<div class="inner">
							

<p><a href="http://blogs.msmvps.com/peterritchie/2008/01/07/why-is-immutability-important/" title="Permalink to Why is immutability important.">Source</a></p>
<h1 id="why-is-immutability-important">Why is immutability important.</h1>
<p>There's been some discussion about the adding the ability for immutable types in a future CLR and C# (I assume other .NET languages in the same timeframe would follow suit; but, to be honest, I don't follow the other popular ones). But, some of you are wondering, &quot;why?&quot;</p>
<p>Is this simply just an off-shoot of C++'s &quot;const&quot;? Not really. The proposed immutabilities would be compile and run-time enforced. C++'s const can be casted-away.</p>
<p>There's a few techniques to writing thread-safe/concurrent/parallel code, amongst them: messenging and locking/synchronization. Messenging works because each thread is supposed operate on a copy of the data or each thread is part of a work-flow waiting on a message from another to do its work. This works in two parts: one no thread is operating with same data at the same time as another, and dependant threads awaken/start another thread as they sleep/stop via a message. Unless your programming language supports/implements this method of threading, you have to write a large and complex framework for it to work. The other technique, which is most prevalent with C#, is locking/synchronization. Each thread let's other thread know that it's working on specific data by taking a lock. No other threads can take the lock, so whatever that lock is guarding (yes, that assumes both threads do anything with that data lock the same lock) causes data access to be &quot;synchronized&quot; amongst the threads. This works; but locking is really slow. .NET includes the Monitor class specifically to get a user-mode synchronization primitive. Using the Windows synchronization objects (like mutexes) require a kernal mode round-trip which is really expestive. This is why you see other techniques like &quot;low-lock&quot;. Locking is more diffuclt than messenging because any thread is free to have multiple locks. &quot;Lock-leveling&quot; is a way to compensate for this, but it's still very difficult and time-consuming to get right.</p>
<p>I'm a big fan of being explicit when I'm designing and programming. In C#, If I haven't designed a class to be a base class, I declare sealed and the compiler will raise an error if someone tries to derive from that class. In C++, if I don't modify the value of a parameter I declare it const; if the code was changed to modify the value, the compiler will raise an error. If I've designed a class to be immutable, it would be nice to be able to declare it immutable and be enforced.</p>
<p>There are a few benefits to being able to declare a class immutable. One is that I can then be free not to worry about using an instance of that type by multipe threads–it is thread-safe. You can write code /now/ to create a type that exhibits immutability; but if you work with many different developers like I do, you have no way to enforce that (to the point where the compiler will raise an error and poke the person who made the change and reenforce my design constraints). Another is the ability to embrace functional programming paradigms. Much of the functional programming space hinges on immutable data. And yet another is the ability to declare a type with true value semantics.</p>
<p>There are other benefits, but they mostly relate to being able to enforce a design constraint, like implementing temporal object pattern, etc.</p>
<p>Could immutability simply be another contract in an ability to enforce design contracts? Sure, that's one way of doing it. It requires a contract framework to support it (Spec#) but it could be part of that. Could it live all on it's own? Of course, you could do something similar to other run-time and compile-time features (get a reference)</p>


<div id="disqus_thread"></div>  
<!--
    'Why-is-immutability-important.'
    'Why is immutability important.'
    'http://blog.peterritchie.com/posts/Why-is-immutability-important.'
-->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */

    var fromJekyllDate = new Date('Wed Feb 01 2022');
    var publishedDate = new Date('1/7/2008');
    console.info('Why-is-immutability-important.');

    var disqus_identifier = '';
    var disqus_shortname = 'peterritchiesblog'; // required: replace example with your forum shortname
    var disqus_title = 'Why is immutability important.';
    var disqus_url = 'http://blog.peterritchie.com/posts/Why-is-immutability-important.';

    if(publishedDate < fromJekyllDate)
    {
        disqus_url = disqus_url.replace('/posts', '');
        disqus_url = disqus_url + '/';
    }
    else
    {
        //var disqus_identifier = 'Why-is-immutability-important.';
    }
    console.info(disqus_identifier);

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
						</div>
					</section>
				
				</section>
				
				<!-- Footer -->
                <footer id="footer">
                    <div class="container">
        <div class="row">
                <div class="col-md-12 text-center">
                    <p class="copyright text-muted">
                        Copyright © Peter Ritchie&#x27;s Blog 2022
                        <br />
                            <a href="/feed.xml"><i class="fa fa-rss"></i> RSS Feed</a>
                        |
                            <a href="/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
                        <br />
                        <strong><a href="https://wyam.io">Generated by "Wyam"</a></strong>
                    </p>
                </div>
        </div>
</div>
                </footer>
			</div>

		<!-- Scripts -->
			<script src="/assets/js/skel.min.js"></script>
			<script src="/assets/js/jquery.min.js"></script>
			<script src="/assets/js/jquery.scrollex.min.js"></script>
			<script src="/assets/js/util.js"></script>
            <!--[if lte IE 8]><script src="/assets/js/ie/respond.min.js"></script><![endif]-->
            <script src="/assets/js/main.js"></script>

	</body>

</html>