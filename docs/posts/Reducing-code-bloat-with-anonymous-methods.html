

<!DOCTYPE HTML>
<!--
	Solid State by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Peter Ritchie&#x27;s Blog - Reducing code-bloat with anonymous methods</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="/assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="/assets/sass/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="/assets/sass/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="/assets/sass/ie8.css" /><![endif]-->
        

	</head>
	<body>

		<!-- Page Wrapper -->
			<div id="page-wrapper">
				
				<!-- Header -->
				<header id="header">
					<h1><a href="/">Peter Ritchie&#x27;s Blog</a></h1>
					<nav>
						<a href="#menu">Menu</a>
					</nav>
				</header>

				<!-- Menu -->
				<nav id="menu">
					<div class="inner">
						<h2>Menu</h2>
						<ul class="links">
							        <li><a href="/posts">Archive</a></li>
        <li><a href="/tags">Tags</a></li>
        <li><a href="/about">About</a></li>

						</ul>
						<a href="#" class="close">Close</a>
					</div>
				</nav>


    
<section id="banner">
  <div class="inner">
    <h2>Reducing code-bloat with anonymous methods</h2>
            <p><em>Published on Tuesday, February 6, 2007</em></p>
                    <a role="button" href="/tags/February-2007" class="button small">February 2007</a>
                <a role="button" href="/tags/msmvps" class="button small">msmvps</a>
                <a role="button" href="/tags/Uncategorized" class="button small">Uncategorized</a>
  </div>
</section>

				<!-- Main -->
				<section id="wrapper">
					<section class="wrapper style2">
						<div class="inner">
							

<p><a href="http://blogs.msmvps.com/peterritchie/2007/02/06/reducing-code-bloat-with-anonymous-methods/" title="Permalink to Reducing code-bloat with anonymous methods">Source</a></p>
<h1 id="reducing-code-bloat-with-anonymous-methods">Reducing code-bloat with anonymous methods</h1>
<p>C# 2.0 introduced anonymous methods that allow programmers to create a callable block of code thatuses parameters but is notdeclared as a method. One of the places I find this to be most useful is with Invoke and BeginInvoke. Often times, invoking a delegate is used internal to a class to perform asynchronous processing or to ensure code is executed on the GUI thread.</p>
<p>Events generally don't have a particular thread their handlersare run on; it's up to the code raising the event which thread is used. Code that modifies WinForm control data must be run on the GUI thread. If the codethat modifies control data is in an event handler, you run the risk of causing hard-to-reproduceinstability. Rather than create a new delegate type, a method to be wrapped by your new delegate type, and code to instantiate the delegate when needed; you can use an anonymous method. For example,if in the processing of an event you wanted to add an entry to a ListBox, to ensure the code didn't cause any cross-threading exceptionsor hard-to-reproduce instability you'd have to implement something like:</p>
<p>private delegate void StringToListBox(String item);</p>
<p>private void AddStringToListBox(String item)</p>
<p>{</p>
<p>listBox1.Items.Add(item);</p>
<p>}</p>
<p>void myClass_MyEvent ( object sender, EventArgs e )</p>
<p>{</p>
<p>String item = DateTime.Now.ToString();</p>
<p>listBox1.BeginInvoke(new StringToListBox(AddStringToListBox),</p>
<p item="">new object[] );</p>
<p>}</p>
<p>This lends itself to re-usability; but if you're only using AddStringToListBox in the one event handler, that's a lot of baggage. Plus, you don't get type safety passing an Object array to the delegate invocation. Anonymous methods can reduce this down to a single call to BeginInvoke. For example:</p>
<p>void myClass_MyEvent ( object sender, EventArgs e )</p>
<p>{</p>
<p>String item = DateTime.Now.ToString();</p>
<p>listBox1.BeginInvoke((MethodInvoker)delegate( )</p>
<p>{</p>
<p>listBox1.Items.Add(item);</p>
<p>});</p>
<p>}</p>
<p>Type safety is no longer an issue and you're not polluting the class' name space with a method thatcould bemisused. For WinForm control events this is not necessary because theyare raisedon the GUI thread.</p>


<div id="disqus_thread"></div>  
<!--
    'Reducing-code-bloat-with-anonymous-methods'
    'Reducing code-bloat with anonymous methods'
    'http://blog.peterritchie.com/posts/Reducing-code-bloat-with-anonymous-methods'
-->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */

    var fromJekyllDate = new Date('Wed Feb 01 2022');
    var publishedDate = new Date('2/6/2007');
    console.info('Reducing-code-bloat-with-anonymous-methods');

    var disqus_identifier = '';
    var disqus_shortname = 'peterritchiesblog'; // required: replace example with your forum shortname
    var disqus_title = 'Reducing code-bloat with anonymous methods';
    var disqus_url = 'http://blog.peterritchie.com/posts/Reducing-code-bloat-with-anonymous-methods';

    if(publishedDate < fromJekyllDate)
    {
        disqus_url = disqus_url.replace('/posts', '');
        disqus_url = disqus_url + '/';
    }
    else
    {
        //var disqus_identifier = 'Reducing-code-bloat-with-anonymous-methods';
    }
    console.info(disqus_identifier);

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
						</div>
					</section>
				
				</section>
				
				<!-- Footer -->
                <footer id="footer">
                    <div class="container">
        <div class="row">
                <div class="col-md-12 text-center">
                    <p class="copyright text-muted">
                        Copyright © Peter Ritchie&#x27;s Blog 2022
                        <br />
                            <a href="/feed.xml"><i class="fa fa-rss"></i> RSS Feed</a>
                        |
                            <a href="/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
                        <br />
                        <strong><a href="https://wyam.io">Generated by "Wyam"</a></strong>
                    </p>
                </div>
        </div>
</div>
                </footer>
			</div>

		<!-- Scripts -->
			<script src="/assets/js/skel.min.js"></script>
			<script src="/assets/js/jquery.min.js"></script>
			<script src="/assets/js/jquery.scrollex.min.js"></script>
			<script src="/assets/js/util.js"></script>
            <!--[if lte IE 8]><script src="/assets/js/ie/respond.min.js"></script><![endif]-->
            <script src="/assets/js/main.js"></script>

	</body>

</html>