

<!DOCTYPE HTML>
<!--
	Solid State by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Peter Ritchie&#x27;s Blog - Dynamic Features in C#</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="/assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="/assets/sass/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="/assets/sass/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="/assets/sass/ie8.css" /><![endif]-->
        

	</head>
	<body>

		<!-- Page Wrapper -->
			<div id="page-wrapper">
				
				<!-- Header -->
				<header id="header">
					<h1><a href="/">Peter Ritchie&#x27;s Blog</a></h1>
					<nav>
						<a href="#menu">Menu</a>
					</nav>
				</header>

				<!-- Menu -->
				<nav id="menu">
					<div class="inner">
						<h2>Menu</h2>
						<ul class="links">
							        <li><a href="/posts">Archive</a></li>
        <li><a href="/tags">Tags</a></li>
        <li><a href="/about">About</a></li>

						</ul>
						<a href="#" class="close">Close</a>
					</div>
				</nav>


    
<section id="banner">
  <div class="inner">
    <h2>Dynamic Features in C#</h2>
            <p><em>Published on Friday, November 14, 2008</em></p>
                    <a role="button" href="/tags/C%23-4" class="button small">C# 4</a>
                <a role="button" href="/tags/msmvps" class="button small">msmvps</a>
                <a role="button" href="/tags/November-2008" class="button small">November 2008</a>
  </div>
</section>

				<!-- Main -->
				<section id="wrapper">
					<section class="wrapper style2">
						<div class="inner">
							

<p><a href="http://blogs.msmvps.com/peterritchie/2008/11/14/dynamic-features-in-c/" title="Permalink to Dynamic Features in C#">Source</a></p>
<h1 id="dynamic-features-in-c">Dynamic Features in C#</h1>
<p>.NET is the evolution of COM. .NET was rumoured to be originally called COM+ 2.5.</p>
<p>.NET has evolved well beyond COM and while it fulfils many of the goals that COM originally tried to fulfil, .NET removes many of the COM trappings that developers have to deal with.</p>
<p>C# is a .NET language with C++ heritage. C++, unlike VB is not a dynamic language. C# was only dynamic in that it provided COM interop abilities. You can program to any COM API you like, as long as you know what you're talking to. This is generally not a problem for 99% of COM libraries. But, COM libraries offer the ability to be strongly typed and/or completely dynamic. This means a method may return a value that simply isn't known until runtime. In C#, if you know what the type of that value will be a runtime, you can simply cast it to that type and it will work fine a runtime–sort of hiding the fact that it's really dynamic. If you debug C# code that deals with COM APIs, you may have noticed the type of some COM objects are __ComObject–encapsulating the fact that type information doesn't really exist until runtime.</p>
<p>The problem with dealing with some dynamic COM APIs is that what the actual type of some return values simply isn't documented at runtime. In dynamic languages you can write things like this:</p>
<p>var obj = GetSomeObject();<br />
obj.SomeMethod();</p>
<p>&quot;SomeMethod&quot; simply won't be resolved until runtime. The above code effectively means &quot;after you get the object from the GetSomeObject method, query the object for information about the &quot;SomeMethod&quot; method and if it exists, invoke it. This is like duck typing.</p>
<p>I say 99% of COM APIs because most COM APIs are written to be consumed by strongly-typed languages like C++. But, COM doesn't require an object to have a strong type; an API can be written that completely relies upon checking for members at runtime.</p>
<p>This has been a problem with C# because it simply hadn't supported that. As I said, you can get around types with methods that return dynamic types through casting; but if that type is never concretely defined anywhere that cast would be impossible.</p>
<p>C# 4 adds dynamic support to the language so it can now support circumstances like this. It also makes consuming some COM APIs much easier because you don't have to know specific type information at compile-time. You can get by with member names and leave it to the runtime to find the physical members for you, at run-time.</p>
<p>Oddly, the Visual Studio automation and extensibility API is based on this dynamic ability. Mostly legacy because Visual Studio has been around well before .NET and has supported automation and extensibility since then. This extensibility was based on COM. We have Visual Studio support .NET now, but the evolution of that extensibility has continued to support COM. Plus, Visual Studio also supports non .NET languages and thus must support extensibility with those languages and COM is generally accepted means of doing that.</p>
<p>For the most part, the extensibility model of Visual Studio is documented in VB. In VB you have much more freedom to accept dynamic APIs. Let's have a look at some examples from the documentation:</p>


<div id="disqus_thread"></div>  
<!--
    'Dynamic-Features-in-C%23'
    'Dynamic Features in C#'
    'http://blog.peterritchie.com/posts/Dynamic-Features-in-C%23'
-->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */

    var fromJekyllDate = new Date('Wed Feb 01 2022');
    var publishedDate = new Date('11/14/2008');
    console.info('Dynamic-Features-in-C%23');

    var disqus_identifier = '';
    var disqus_shortname = 'peterritchiesblog'; // required: replace example with your forum shortname
    var disqus_title = 'Dynamic Features in C#';
    var disqus_url = 'http://blog.peterritchie.com/posts/Dynamic-Features-in-C%23';

    if(publishedDate < fromJekyllDate)
    {
        disqus_url = disqus_url.replace('/posts', '');
        disqus_url = disqus_url + '/';
    }
    else
    {
        //var disqus_identifier = 'Dynamic-Features-in-C%23';
    }
    console.info(disqus_identifier);

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
						</div>
					</section>
				
				</section>
				
				<!-- Footer -->
                <footer id="footer">
                    <div class="container">
        <div class="row">
                <div class="col-md-12 text-center">
                    <p class="copyright text-muted">
                        Copyright © Peter Ritchie&#x27;s Blog 2022
                        <br />
                            <a href="/feed.xml"><i class="fa fa-rss"></i> RSS Feed</a>
                        |
                            <a href="/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
                        <br />
                        <strong><a href="https://wyam.io">Generated by "Wyam"</a></strong>
                    </p>
                </div>
        </div>
</div>
                </footer>
			</div>

		<!-- Scripts -->
			<script src="/assets/js/skel.min.js"></script>
			<script src="/assets/js/jquery.min.js"></script>
			<script src="/assets/js/jquery.scrollex.min.js"></script>
			<script src="/assets/js/util.js"></script>
            <!--[if lte IE 8]><script src="/assets/js/ie/respond.min.js"></script><![endif]-->
            <script src="/assets/js/main.js"></script>

	</body>

</html>