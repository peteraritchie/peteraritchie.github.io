
<!DOCTYPE html>
<html lang="en">
        <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>

        <title>Peter Ritchie&#x27;s Blog - New And Proposed Changes For C# 13 - June 5, 2024</title>
        <meta name="description" content="Peter Ritchie" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">        

        <link type="application/rss+xml" rel="alternate" title="Peter Ritchie&#x27;s Blog" href="/feed.xml" />
                <link type="application/atom+xml" rel="alternate" title="Peter Ritchie&#x27;s Blog" href="/feed.atom" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">

        <link href="/assets/css/bootstrap.min.css" rel="stylesheet" />
        <link href="/assets/css/highlight.css" rel="stylesheet">
        <link href="/assets/css/clean-blog.css" rel="stylesheet" />
        <link href="/assets/css/master.css" rel="stylesheet" />
        <link href="/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
        <link href="/assets/css/override.css" rel="stylesheet" />


        <meta name="application-name" content="Peter Ritchie&#x27;s Blog" />
        <meta name="msapplication-tooltip" content="Peter Ritchie&#x27;s Blog" />
        <meta name="msapplication-starturl" content="/" />

        <meta property="og:title" content="Peter Ritchie&#x27;s Blog - New And Proposed Changes For C# 13 - June 5, 2024" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="http://blog.peterritchie.com/posts/new-and-proposed-changes-in-csharp-13-2024-jun-5" />
        <!-- TODO: More social graph meta tags -->

        


        </head>
        <body>
                
                <!-- Navigation -->
                <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
                        <div class="container-fluid">
                                <!-- Brand and toggle get grouped for better mobile display -->
                                <div class="navbar-header page-scroll">
                                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
                                        <span class="sr-only">Toggle navigation</span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        </button>
                                        <a class="navbar-brand" href="/">Peter Ritchie&#x27;s Blog</a>
                                </div>
                        
                                <!-- Collect the nav links, forms, and other content for toggling -->
                                <div class="collapse navbar-collapse" id="navbar-collapse">
                                        <ul class="nav navbar-nav navbar-right">
                                                        <li><a href="/posts">Archive</a></li>
        <li><a href="/tags">Tags</a></li>
        <li><a href="/about">About</a></li>
        <li><a href="/testing">Testing</a></li>
 
                                        </ul>
                                </div>
                                <!-- /.navbar-collapse -->
                        </div>
                        <!-- /.container -->
                </nav>
                
                <!-- Page Header -->
                <header class="intro-header" id="intro-header">
                        <div class="container">
                                <div class="row">
                                        <div class="col-md-12">

    
<div class="post-heading">
    <h1>New And Proposed Changes For C# 13 - June 5, 2024</h1>
    <div class="meta">        
Published on Wednesday, June 5, 2024<br>    </div>
        <div class="tags">
                    <a role="button" href="/tags/NET" class="btn btn-default btn-xs">.NET</a>
                    <a role="button" href="/tags/NET-9" class="btn btn-default btn-xs">.NET 9</a>
                    <a role="button" href="/tags/C%23" class="btn btn-default btn-xs">C#</a>
                    <a role="button" href="/tags/C%23-13" class="btn btn-default btn-xs">C# 13</a>
        </div>     
</div>
                                        </div>
                                </div>
                        </div>
                </header>
                
                <!-- Main Content -->
                <div class="container">
                        <div class="row">
                                <div id="content" class="col-md-12">
                                        

<p><img src="../assets/types-of-extensions.png" class="img-fluid" alt="Extensions, extensions, extensions" /></p>
<p>C# 13 is shaping up to introduce some interesting and useful additions to the C# language. Let's look at what we know as of June 5, 2024.</p>
<h2 id="extension-types">Extension Types</h2>
<p><em>Extension Types</em> (announced at Build 2024) are the latest proposed addition to C# 13. Microsoft introduced <em>Extension Methods</em> in C# 3, and since C# 4, the concept of &quot;Extension Everything&quot; has been an anticipated addition. <em>Extension Methods</em> added the ability to extend non-static classes with statically-defined methods in unrelated static classes. <em>Extension Types</em> extend the extensibility that Extension Methods offer, a huge leap towards Extension Everything.</p>
<p>Extension Methods syntax stays the same, but you can be clearer about the intent of your extension methods by declaring implicit extension classes.</p>
<p>An extension method in C#3-C#12 may look like this:</p>
<pre><code class="language-csharp">public static class StringExtensions
{
    public static bool IsNotNullOrEmpty(this string text)
    {
        return !string.IsNullOrEmpty(text);
    }
}
</code></pre>
<p>The above code introduces the ability to do something like <code>myText.IsNotNullOrEmpty()</code>. In C# 13, you can be more direct (I'm trying to avoid using the word &quot;explicit&quot;; you'll see why in a sec.) by declaring an <em>implicit extension</em> class with what looks like an instance method <code>IsNotNullOrEmpty</code>:</p>
<pre><code class="language-csharp">implicit extension StringExtensions for string
{
    public bool IsNotNullOrEmpty()
    {
        return !string.IsNullOrEmpty(this);
    }
}
</code></pre>
<p>This alternative way to re-implement an extension method implements an instance method on the extension class—which is how the extension method appears when used: a call to a method on an instance of a type (<code>string</code> in our example.) We're not limited to extending the <em>instance</em> of a type; we can also extend the type with static methods. <code>IsNotNullOrEmpty</code> is looking to be the opposite of the static <code>string</code> method <code>IsNullOrEmpty</code>. With Extension Types we will be able to implement <code>IsNotNullOrEmpty</code> as a static method on <code>string</code></p>
<pre><code class="language-csharp">implicit extension StringExtensions for string
{
    public static bool IsNotNullOrEmpty(string text)
    {
        return !string.IsNullOrEmpty(text);
    }
}
</code></pre>
<p>The above code adds a <strong>static extension method</strong> that allows for <code>string.IsNotNullOrEmpty(myText)</code>.</p>
<p>But, since the code will truly be in the context—or scope of—<code>string</code>, I don't need to qualify the call to <code>IsNullOrEmpty</code> with the type <code>string</code>! So, we could do this instead:</p>
<pre><code class="language-csharp">implicit extension StringExtensions for string
{
    public static bool IsNotNullOrEmpty(string text)
    {
        return !IsNullOrEmpty(text);
    }
}
</code></pre>
<p>Since this is &quot;Extensions Types,&quot; we will also have <em>extension properties</em>. Continuing with my theme of IsNotNullOrEmpty (potentially in a controversial way), we could implement my original extension method as an extension property:</p>
<pre><code class="language-csharp">implicit extension StringExtensions for string
{
    public bool IsNotNullOrEmpty =&gt; !IsNullOrEmpty(this);
}
</code></pre>
<p>The above code allows us to write <code>myText.IsNotNullOrEmpty</code>. (Feel free to comment that I'm mad for making a property on a potentially <code>null</code> instance of a <code>string</code>, this is just an example.)</p>
<p>Extension Types isn't limited to extension methods and properties but also includes extension indexers. Stealing from Dustin and Mads' demo, let's say we want to provide access to individual bits with a <code>UInt64</code>; I could write an implicit extension type like this:</p>
<pre><code class="language-csharp">public implicit extension Bits for Uint64)
{
    public bool this[int index]
    {
        get =&gt; (this &amp; Mask(index)) != 0;
        set =&gt; this = value ? this | Mask(value) : this &amp; !Mash(index);
    }
    
    static ulong Mask(int index) =&gt; `ul &lt;&lt; index;
}
</code></pre>
<p>... so I could obtain the first bit of an unsigned 64-bit number with <code>unsigned64BitNumber[0]</code>!</p>
<p>What's with <code>implicit</code>? Like implicit operators that will be resolved to based on inferred scope or that it <em>implicitly</em> applies to all cases of the underlying type (<code>... for &lt;type&gt;</code>.) The keyword <code>explicit</code> means a caller can only use the member in an explicitly-qualified scope. So, if I made my <code>StringExtensions</code> class <code>explicit</code> instead, the use of <code>IsNullOrEmpty</code> would only be callable by qualifying with <code>StringExtensions</code>: <code>(StringExtensions)myText.IsNotNullOrEmpty</code>. At least, that's what's currently proposed.</p>
<p>Extension Types is a work in progress, so some of these things may change—I expect details around <code>explicit</code> usage to change.</p>
<h2 id="new-field-contextual-keyword">New <code>field</code> Contextual Keyword</h2>
<p>A feature that almost made it into C# 12 is the <code>field</code> contextual keyword--contextual in autoproperties. <code>field</code> is an &quot;alias&quot; got access the auto-generated backing field.</p>
<p>Since you could declare a variable within the context of an autoproperty, <code>field</code> is technically a breaking change.</p>
<h2 id="params-collections"><code>params</code> Collections</h2>
<p><code>params</code> has existed in C# since the start as a means of declaring a method that takes a variable number of arguments. Generic types were not available at the time, so <code>params</code> only works with <em>arrays</em>, for example, <code>void Method(params string[] args)</code> or <code>void Method(params int[] numbers)</code>.</p>
<p>This means that <code>ReadOnlySpan&lt;T&gt;</code> may be used with <code>params</code> to realize the performance improvements of spans.</p>
<h2 id="system.threading.lock-type-and-lock"><code>System.Threading.Lock</code> Type and <code>lock</code></h2>
<p>.NET 9 introduces an improved lock type <code>System.Threading.Lock</code>. <code>System.Threading.Lock</code> offers improvements over <code>Monitor</code> in that <code>Lock</code> supports a narrower locking scope and avoids the overhead of SyncBlock.</p>
<p>C# 13 <code>lock</code> recognizes if the target is <code>System.Threading.Lock</code> and uses its updated API.</p>
<h2 id="new-escape-sequence-for-esc-character">New Escape Sequence For <kbd>Esc</kbd> Character</h2>
<p>You can now enter <kbd>Esc</kbd> as a string/character literal with <code>'\e'</code>. Prior to C# 13, having the <kbd>Esc</kbd> character in a string would require typing <code>\u001b</code> (or <code>\x1b</code>, but that's not recommended.) I believe this accepts the existing Regular Expression character sequence of <code>\e</code> as an escape for <kbd>Esc</kbd>.</p>
<h2 id="improved-overload-resolution-for-method-groups">Improved Overload Resolution For Method Groups</h2>
<p>C# 13 will improve overload resolution of method groups when determining the method group's natural type. Oversimplication: instead of generating all possible candidate methods and selecting the best candidate, candidates will be constructed scope by scope. If, after pruning all the candidates at one scope, candidates at the next scope are constructed and considered. If you're interested at that level, see <a href="https://github.com/dotnet/roslyn/issues/69222">Generic constraints should prune out candidates for method group natural type</a></p>
<h2 id="index-operator-now-available-in-object-initializer-expressions">Index operator <code>^</code> Now Available In Object Initializer Expressions</h2>
<p>You can now use the &quot;From the end&quot; operator in object initializer expressions. e.g.:</p>
<pre><code class="language-csharp">var countdown = new TimerRemaining()
{
    buffer =
    {
        [^1] = 0,
        [^2] = 1,
        [^3] = 2,
        [^4] = 3,
        [^5] = 4,
        [^6] = 5,
        [^7] = 6,
        [^8] = 7,
        [^9] = 8,
        [^10] = 9
    }
};
</code></pre>
<h2 id="caveat">Caveat</h2>
<p>&quot;C# 13&quot; is a work in progress, and the above was accurate when it was published. Hopefully we'll get everything detailed above but we may not. We may not get some of these features or we may get more!</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/dotnet/roslyn/issues/11159">Language Feature: Extension Everything</a></li>
<li><a href="https://github.com/dotnet/csharplang/issues/5497">[Proposal]: Extensions</a></li>
<li><a href="https://github.com/dotnet/csharplang/issues/140">Proposal: Semi-Auto-Properties; field keyword</a></li>
<li><a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/params-collections"><code>params</code> Collections Feature Proposal</a></li>
<li><a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/lock-object">Lock Object Feature Specification</a></li>
<li><a href="https://github.com/dotnet/csharplang/issues/7400">[Proposal]: String/Character escape sequence \e as a short-hand for \u001b (&lt;ESCAPE&gt;)</a></li>
<li><a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/method-group-natural-type-improvements">Method group natural type improvements</a></li>
<li><a href="https://github.com/dotnet/csharplang/issues/7429">[Proposal]: Method group natural type improvements</a></li>
<li><a href="https://github.com/dotnet/csharplang/issues/7684">Open issue: evaluation of implicit indexers in object initializers</a></li>
</ul>


<div id="disqus_thread"></div>  
<!--
    'new-and-proposed-changes-in-csharp-13-2024-jun-5'
    'New And Proposed Changes For C# 13 - June 5, 2024'
    'http://blog.peterritchie.com/posts/new-and-proposed-changes-in-csharp-13-2024-jun-5'
-->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */

    var fromJekyllDate = new Date('Wed Feb 01 2022');
    var publishedDate = new Date('6/5/24');
    console.info('new-and-proposed-changes-in-csharp-13-2024-jun-5');

    var disqus_identifier = '';
    var disqus_shortname = 'peterritchiesblog'; // required: replace example with your forum shortname
    var disqus_title = 'New And Proposed Changes For C# 13 - June 5, 2024';
    var disqus_url = 'http://blog.peterritchie.com/posts/new-and-proposed-changes-in-csharp-13-2024-jun-5';

    if(publishedDate < fromJekyllDate)
    {
        disqus_url = disqus_url.replace('/posts', '');
        disqus_url = disqus_url + '/';
    }
    else
    {
        //var disqus_identifier = 'new-and-proposed-changes-in-csharp-13-2024-jun-5';
    }
    console.info(disqus_identifier);

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                                </div>
                        </div>
                </div>
                
                <hr>
                
                <!-- Footer -->
                <footer>
                        <div class="container">
        <div class="row">
                <div class="col-md-12 text-center">
                    <p class="copyright text-muted">
                        Copyright © Peter Ritchie&#x27;s Blog 2025
                        <br />
                            <a href="/feed.xml"><i class="fa fa-rss"></i> RSS Feed</a>
                        |
                            <a href="/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
                        <br />
                        <strong><a href="https://wyam.io">Generated by "Wyam"</a></strong>
                        <br/>
                        <a rel="me" href="https://mastodon.social/@peterritchie">Mastodon.social</a>&nbsp;|&nbsp;<a rel="me" href="https://fosstodon.org/@peterritchie">fosstodon.org</a>&nbsp;|&nbsp;<a rel="me" href="https://twitter.com/peterritchie">Twitter</a>&nbsp;|&nbsp;<a rel="me" href="https://www.linkedin.com/in/peteraritchie/">LinkedIn</a>&nbsp;|&nbsp;<a rel="me" href="https://bsky.app/profile/peterritchie.com">Bluesky</a>
                    </p>
                </div>
        </div>
</div>
                </footer> 

                <script src="/assets/js/jquery.min.js"></script>
                <script src="/assets/js/bootstrap.min.js"></script>     
                <script src="/assets/js/highlight.pack.js"></script>   
                <script src="/assets/js/clean-blog.js"></script>
                <script src="/assets/js/d3.v3.min.js"></script>
                <script src="/assets/js/trianglify.min.js"></script>
                <script src="/assets/js/Please-compressed.js"></script>
                <script src="/assets/js/background-check.min.js"></script>

                <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
                <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
                <!--[if lt IE 9]>
                        <script src="/assets/js/html5shiv.js"></script>
                        <script src="/assets/js/respond.min.js"></script>
                <![endif]-->
                
                
                <script>hljs.initHighlightingOnLoad();</script>

                        <script type="text/javascript">                
                                // Header background                        
                                var colors = Please.make_color({
                                        colors_returned: 3,
                                        saturation: .6
                                });
                                var t = new Trianglify({
                                        x_gradient: colors,
                                        y_gradient: ["#FFFFFF"]
                                });
                                var header = document.getElementById("intro-header");
                                var pattern = t.generate(header.clientWidth, header.clientHeight);
                                header.setAttribute('style', 'background-image: ' + pattern.dataUrl);                        
                        </script>

                <script>
                        BackgroundCheck.init({
                                targets: '.intro-header,.navbar',
                                images: '.intro-header'
                        });
                </script>
        </body>
</html>

