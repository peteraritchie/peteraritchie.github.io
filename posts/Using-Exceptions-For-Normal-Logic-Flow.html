
<!DOCTYPE html>
<html lang="en">
        <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>

        <title>Peter Ritchie&#x27;s Blog - Using Exceptions For Normal Logic Flow</title>
        <meta name="description" content="Peter Ritchie" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">        

        <link type="application/rss+xml" rel="alternate" title="Peter Ritchie&#x27;s Blog" href="/feed.xml" />
                <link type="application/atom+xml" rel="alternate" title="Peter Ritchie&#x27;s Blog" href="/feed.atom" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">

        <link href="/assets/css/bootstrap.min.css" rel="stylesheet" />
        <link href="/assets/css/highlight.css" rel="stylesheet">
        <link href="/assets/css/clean-blog.css" rel="stylesheet" />
        <link href="/assets/css/master.css" rel="stylesheet" />
        <link href="/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
        <link href="/assets/css/override.css" rel="stylesheet" />


        <meta name="application-name" content="Peter Ritchie&#x27;s Blog" />
        <meta name="msapplication-tooltip" content="Peter Ritchie&#x27;s Blog" />
        <meta name="msapplication-starturl" content="/" />

        <meta property="og:title" content="Peter Ritchie&#x27;s Blog - Using Exceptions For Normal Logic Flow" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="http://blog.peterritchie.com/posts/Using-Exceptions-For-Normal-Logic-Flow" />
        <!-- TODO: More social graph meta tags -->

        


        </head>
        <body>
                
                <!-- Navigation -->
                <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
                        <div class="container-fluid">
                                <!-- Brand and toggle get grouped for better mobile display -->
                                <div class="navbar-header page-scroll">
                                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
                                        <span class="sr-only">Toggle navigation</span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        </button>
                                        <a class="navbar-brand" href="/">Peter Ritchie&#x27;s Blog</a>
                                </div>
                        
                                <!-- Collect the nav links, forms, and other content for toggling -->
                                <div class="collapse navbar-collapse" id="navbar-collapse">
                                        <ul class="nav navbar-nav navbar-right">
                                                        <li><a href="/posts">Archive</a></li>
        <li><a href="/tags">Tags</a></li>
        <li><a href="/about">About</a></li>
 
                                        </ul>
                                </div>
                                <!-- /.navbar-collapse -->
                        </div>
                        <!-- /.container -->
                </nav>
                
                <!-- Page Header -->
                <header class="intro-header" id="intro-header">
                        <div class="container">
                                <div class="row">
                                        <div class="col-md-12">

    
<div class="post-heading">
    <h1>Using Exceptions For Normal Logic Flow</h1>
    <div class="meta">        
Published on Friday, October 12, 2007<br>    </div>
        <div class="tags">
                    <a role="button" href="/tags/NET-20" class="btn btn-default btn-xs">.NET 2.0</a>
                    <a role="button" href="/tags/NET-Development" class="btn btn-default btn-xs">.NET Development</a>
                    <a role="button" href="/tags/C%23" class="btn btn-default btn-xs">C#</a>
                    <a role="button" href="/tags/October-2007" class="btn btn-default btn-xs">October 2007</a>
                    <a role="button" href="/tags/Rant" class="btn btn-default btn-xs">Rant</a>
                    <a role="button" href="/tags/msmvps" class="btn btn-default btn-xs">msmvps</a>
        </div>     
</div>
                                        </div>
                                </div>
                        </div>
                </header>
                
                <!-- Main Content -->
                <div class="container">
                        <div class="row">
                                <div id="content" class="col-md-12">
                                        

<p><a href="http://blogs.msmvps.com/peterritchie/2007/10/12/using-exceptions-for-normal-logic-flow/" title="Permalink to Using Exceptions For Normal Logic Flow">Source</a></p>
<h1 id="using-exceptions-for-normal-logic-flow">Using Exceptions For Normal Logic Flow</h1>
<p>The generally accepted wisdom is that you shouldn't use Exceptions for normal logic flow. Normal logic flow is a bit subjective; but anything that must happen at least once in all known scenarios is normal logic flow.</p>
<p>Enter XML Serialization in the framework. The framework actually dynamically creates types that perform the actual serialization of a given type and caches that assembly. The next time that type needs to be serialized it reuses that generated type, reflection is minimized and things happen pretty quickly.</p>
<p>Here's the rub. The framework decides that it must generate the type when Assembly.Load generates an exception. Something like:</p>
<p>Assembly assembly = null;</p>
<p>try</p>
<p>{</p>
<p>assembly = Assembly.Load(assemblyName);</p>
<p>}</p>
<p>catch (Exception)</p>
<p>{</p>
<p>assembly = GenerateTempAssembly();</p>
<p>}</p>
<p>Which means exceptions are being used for normal logic flow, because when the code is first runthe exception is thrown. Now, there's some folks out there (includingfolks at Microsoft) that will say &quot;what's wrong with that, it gets the job done doesn't it?&quot;. Yes, it does get the job done. The problemis there's at least once that Assembly.Load is going to generate an exception (if you modify thetype being serialized it will happen again). Again,some maysay, &quot;So what?&quot;. Well, in Visual Studio there is a BindingFailure Managed Debugging Assistant (MDA) that sits there looking for Assembly.Load failures. This will get kicked off and force a break the first time you try to serialize your type and you're debugging. When you're using XmlSerializer to serialize many different types and you turn on this MDA (after all, it's there and does do some good) then you'll spend a whole bunch of time wading through the BindingFailure MDA.</p>
<p>This has been occurring since XmlSerializer was created. I say &quot;including folks at Microsoft&quot;, because up until a couple of days ago I thought someone was on this problem (although I can't find my sources anymore) at Microsoft. But, the problem still occurs in Ocras Beta 2; which means in the past 3-4 years no one has done a thing about this problem. So, I logged a bug about it on Connect (<a href="https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=304095">https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=304095</a>) and it was quickly closed as &quot;By Design&quot;.</p>
<p>Keep in mind, the &quot;fix&quot; were talking about is simply checking to see if a file exists before trying to load it, something like:</p>
<p>Assembly assembly;</p>
<p>try</p>
<p>{</p>
<p>Debug.Assert(assemblyName.CodeBase.StartsWith(&quot;file:///&quot;, true, System.Globalization.CultureInfo.InvariantCulture));</p>
<p>String path = assemblyName.CodeBase.Substring(8).Replace('/', '');</p>
<p>if (!System.IO.File.Exists(path))</p>
<p>{</p>
<pre><code>assembly = GenerateTempAssembly();
</code></pre>
<p>}</p>
<p>else</p>
<p>{</p>
<pre><code>assembly = Assembly.Load(assemblyName);
</code></pre>
<p>}</p>
<p>}</p>
<p>catch (Exception)</p>
<p>{</p>
<p>assembly = GenerateTempAssembly();</p>
<p>}</p>
<p>…not too tricky…</p>


<div id="disqus_thread"></div>  
<!--
    'Using-Exceptions-For-Normal-Logic-Flow'
    'Using Exceptions For Normal Logic Flow'
    'http://blog.peterritchie.com/posts/Using-Exceptions-For-Normal-Logic-Flow'
-->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */

    var fromJekyllDate = new Date('Wed Feb 01 2022');
    var publishedDate = new Date('10/12/07');
    console.info('Using-Exceptions-For-Normal-Logic-Flow');

    var disqus_identifier = '';
    var disqus_shortname = 'peterritchiesblog'; // required: replace example with your forum shortname
    var disqus_title = 'Using Exceptions For Normal Logic Flow';
    var disqus_url = 'http://blog.peterritchie.com/posts/Using-Exceptions-For-Normal-Logic-Flow';

    if(publishedDate < fromJekyllDate)
    {
        disqus_url = disqus_url.replace('/posts', '');
        disqus_url = disqus_url + '/';
    }
    else
    {
        //var disqus_identifier = 'Using-Exceptions-For-Normal-Logic-Flow';
    }
    console.info(disqus_identifier);

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                                </div>
                        </div>
                </div>
                
                <hr>
                
                <!-- Footer -->
                <footer>
                        <div class="container">
        <div class="row">
                <div class="col-md-12 text-center">
                    <p class="copyright text-muted">
                        Copyright © Peter Ritchie&#x27;s Blog 2023
                        <br />
                            <a href="/feed.xml"><i class="fa fa-rss"></i> RSS Feed</a>
                        |
                            <a href="/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
                        <br />
                        <strong><a href="https://wyam.io">Generated by "Wyam"</a></strong>
                        <br/>
                        <a rel="me" href="https://dotnet.social/@peterritchie">dotnet.social</a>&nbsp;|&nbsp;<a rel="me" href="https://mastodon.social/@peterritchie">Mastodon.social</a>&nbsp;|&nbsp;<a rel="me" href="https://fosstodon.org/@peterritchie">fosstodon.org</a>&nbsp;|&nbsp;<a rel="me" href="https://twitter.com/peterritchie">Twitter</a>&nbsp;|&nbsp;<a rel="me" href="https://www.linkedin.com/in/peteraritchie/">LinkedIn</a>
                    </p>
                </div>
        </div>
</div>
                </footer> 

                <script src="/assets/js/jquery.min.js"></script>
                <script src="/assets/js/bootstrap.min.js"></script>     
                <script src="/assets/js/highlight.pack.js"></script>   
                <script src="/assets/js/clean-blog.js"></script>
                <script src="/assets/js/d3.v3.min.js"></script>
                <script src="/assets/js/trianglify.min.js"></script>
                <script src="/assets/js/Please-compressed.js"></script>
                <script src="/assets/js/background-check.min.js"></script>

                <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
                <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
                <!--[if lt IE 9]>
                        <script src="/assets/js/html5shiv.js"></script>
                        <script src="/assets/js/respond.min.js"></script>
                <![endif]-->
                
                
                <script>hljs.initHighlightingOnLoad();</script>

                        <script type="text/javascript">                
                                // Header background                        
                                var colors = Please.make_color({
                                        colors_returned: 3,
                                        saturation: .6
                                });
                                var t = new Trianglify({
                                        x_gradient: colors,
                                        y_gradient: ["#FFFFFF"]
                                });
                                var header = document.getElementById("intro-header");
                                var pattern = t.generate(header.clientWidth, header.clientHeight);
                                header.setAttribute('style', 'background-image: ' + pattern.dataUrl);                        
                        </script>

                <script>
                        BackgroundCheck.init({
                                targets: '.intro-header,.navbar',
                                images: '.intro-header'
                        });
                </script>
        </body>
</html>

