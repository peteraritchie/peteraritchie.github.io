
<!DOCTYPE html>
<html lang="en">
        <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>

        <title>Peter Ritchie&#x27;s Blog - Using the dynamic Keyword in C# to Improve Object-Orientation</title>
        <meta name="description" content="Peter Ritchie" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">        

        <link type="application/rss+xml" rel="alternate" title="Peter Ritchie&#x27;s Blog" href="/feed.xml" />
                <link type="application/atom+xml" rel="alternate" title="Peter Ritchie&#x27;s Blog" href="/feed.atom" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">

        <link href="/assets/css/bootstrap.min.css" rel="stylesheet" />
        <link href="/assets/css/highlight.css" rel="stylesheet">
        <link href="/assets/css/clean-blog.css" rel="stylesheet" />
        <link href="/assets/css/master.css" rel="stylesheet" />
        <link href="/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
        <link href="/assets/css/override.css" rel="stylesheet" />


        <meta name="application-name" content="Peter Ritchie&#x27;s Blog" />
        <meta name="msapplication-tooltip" content="Peter Ritchie&#x27;s Blog" />
        <meta name="msapplication-starturl" content="/" />

        <meta property="og:title" content="Peter Ritchie&#x27;s Blog - Using the dynamic Keyword in C# to Improve Object-Orientation" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="http://blog.peterritchie.com/posts/Using-the-dynamic-Keyword-in-C%23-to-Improve-Object-Orientation" />
        <!-- TODO: More social graph meta tags -->

        


        </head>
        <body>
                
                <!-- Navigation -->
                <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
                        <div class="container-fluid">
                                <!-- Brand and toggle get grouped for better mobile display -->
                                <div class="navbar-header page-scroll">
                                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
                                        <span class="sr-only">Toggle navigation</span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        </button>
                                        <a class="navbar-brand" href="/">Peter Ritchie&#x27;s Blog</a>
                                </div>
                        
                                <!-- Collect the nav links, forms, and other content for toggling -->
                                <div class="collapse navbar-collapse" id="navbar-collapse">
                                        <ul class="nav navbar-nav navbar-right">
                                                        <li><a href="/posts">Archive</a></li>
        <li><a href="/tags">Tags</a></li>
        <li><a href="/about">About</a></li>
        <li><a href="/testing">Testing</a></li>
 
                                        </ul>
                                </div>
                                <!-- /.navbar-collapse -->
                        </div>
                        <!-- /.container -->
                </nav>
                
                <!-- Page Header -->
                <header class="intro-header" id="intro-header">
                        <div class="container">
                                <div class="row">
                                        <div class="col-md-12">

    
<div class="post-heading">
    <h1>Using the dynamic Keyword in C# to Improve Object-Orientation</h1>
    <div class="meta">        
Published on Monday, May 24, 2010<br>    </div>
        <div class="tags">
                    <a role="button" href="/tags/NET" class="btn btn-default btn-xs">.NET</a>
                    <a role="button" href="/tags/NET-40" class="btn btn-default btn-xs">.NET 4.0</a>
                    <a role="button" href="/tags/NET-Development" class="btn btn-default btn-xs">.NET Development</a>
                    <a role="button" href="/tags/C%23" class="btn btn-default btn-xs">C#</a>
                    <a role="button" href="/tags/C%23-40" class="btn btn-default btn-xs">C# 4.0</a>
                    <a role="button" href="/tags/Code-Smells" class="btn btn-default btn-xs">Code Smells</a>
                    <a role="button" href="/tags/Design/Coding-Guidance" class="btn btn-default btn-xs">Design/Coding Guidance</a>
                    <a role="button" href="/tags/DevCenterPost" class="btn btn-default btn-xs">DevCenterPost</a>
                    <a role="button" href="/tags/OOD" class="btn btn-default btn-xs">OOD</a>
                    <a role="button" href="/tags/Refactoring" class="btn btn-default btn-xs">Refactoring</a>
                    <a role="button" href="/tags/Software-Development" class="btn btn-default btn-xs">Software Development</a>
                    <a role="button" href="/tags/Visual-Studio-2010" class="btn btn-default btn-xs">Visual Studio 2010</a>
                    <a role="button" href="/tags/msmvps" class="btn btn-default btn-xs">msmvps</a>
        </div>     
</div>
                                        </div>
                                </div>
                        </div>
                </header>
                
                <!-- Main Content -->
                <div class="container">
                        <div class="row">
                                <div id="content" class="col-md-12">
                                        

<p><a href="http://blogs.msmvps.com/peterritchie/2010/05/24/using-the-dynamic-keyword-in-c-to-improve-object-orientation/" title="Permalink to Using the dynamic Keyword in C# to Improve Object-Orientation">Source</a></p>
<h1 id="using-the-dynamic-keyword-in-c-to-improve-object-orientation">Using the dynamic Keyword in C# to Improve Object-Orientation</h1>
<p>With polymorphism, object-oriented languages allow &quot;…different data types to be handled using a uniform interface&quot;. Ad-hoc polymorphism is when you declare multiple methods of the same name but differ by the type of an argument. For example:</p>
<pre><code> private  static  void  Draw(Circle  circle)


 {


 	//... 


 }


 private  static  void  Draw(Square  square)


 {


 	//... 


 }


 
</code></pre>
<p>These are usually referred to as <em>method overloads</em> or <em>method overloading</em>. Which Draw method that gets invoked would be decided upon at compile-time based on the type of the parameter passed to it.</p>
<p>This is great, there are many situations where this is useful; but what about situations where you don't know the exact type of the object until run-time? Many programmers instinctly lean towards using the GetType method available on all objects in .NET and perform a manual type comparison. For example:</p>
<pre><code> public  void  ProcessShape(Shape  shape)


 {


 	Type  type = shape.GetType();


 	if  (type == typeof (Square ))


 	{


 		Draw((Square )shape);


 	}


 	else  if  (type == typeof (Circle ))


 	{


 		Draw((Circle )shape);


 	}


 	//... 


 }


 
</code></pre>
<p>There are other variants of this that make it a little harder to detect (and often gets around static code analysis warnings):</p>
<pre><code> public  void  ProcessShape(Shape  shape)


 {


 	Square  square = shape as  Square ;


 	if  (square != null )


 	{


 		Draw(square);


 		return ;


 	}


 	Circle  circle = shape as  Circle ;


 	if  (circle != null )


 	{


 		Draw(circle);


 		return ;


 	}


 	//... 


 }


 
</code></pre>
<p>This code is a problem because we lose the benefits of C#s polymorphism (this code is coupled to Circle and Shape, if either is removed, this code would have to be changed and re-tested. If another Shape derivative were added, the code would again have to be changed and re-tested). There are multiple circumstances where this might happen over and above the so-far specious examples above. For example, deserializing an object from a Stream often results in not knowing the exact type of the object that has been deserialized. This is common with type hierarchies. For example:</p>
<pre><code> private  static  Shape  DeserializeShape(Stream  stream)


 {


 	IFormatter  formatter = new  BinaryFormatter ();


 	return  formatter.Deserialize(stream) as  Shape ;


 }


 
</code></pre>
<p>With the above code, we've re-hydrated either a Circle of a Square object into a Shape object (and ignored the appropriate checks to make sure a Shape object was loaded). We're now unable to use all the other polymorphism features of C#: method overloading won't work, C# will always only use the overload with the Shape argument and generics suffers from the same problem, it will always resolve to the type parameter of type Shape. For example, if we try to call one of our two Draw methods with our re-hydrated Shape object:</p>
<p>…we simply get a CS1502 warning because there is now Draw(Shape shape) method.</p>
<p>When programmers simply compare types, they're admitting that polymorphism has been circumvented and they have to resort to introducing the <em>Conditional Complexity</em> Code Smell or the <em>Switch Statement</em> Code Smell (C# doesn't support Type in a switch statement, so some programmers go ahead and create a integer type code–or even worse, use String in the switch statement)</p>
<p>So, what's a programmer to do to keep our code object-oriented and use polymorphism?</p>
<p>Well, if you read the title of this post, you've probably figured it out: use the dynamic keyword. The dynamic keyword bypasses static (compile-time) type checking and performs the type-checking dynamically (at run-time). So, for us to use our Draw overloads with our Shape object, we simply assign it to a dynamic object and use that object instead. For example:</p>
<pre><code> 			Shape  shape = DeserializeShape(stream);


 			dynamic  dynShape = shape;


 			Draw(dynShape);
</code></pre>
<p>Now the runtime will check to see the actual type of dynShape object and invoke the corresponding Draw overload.</p>
<p>In our example, we've used inheritance to derive our two shapes from a single base. But, given our current use of Circle and Square objects, we don't need them to inherit from the same base class. We could simply view these shapes as an Object when we want to use dynamic. For example:</p>
<pre><code> private  static  Object  DeserializeShape(Stream  stream)


 {


 	IFormatter  formatter = new  BinaryFormatter ();


 	return  formatter.Deserialize(stream);


 }


 


 			//... 


 			dynamic  shape = DeserializeShape(stream);


 			Draw(shape);


 
</code></pre>
<p>With the above, we'd have the same result without deriving both Circle and Square from Shape.</p>
<p><img src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=http%3a%2f%2fmsmvps.com%2fblogs%2fpeterritchie%2farchive%2f2010%2f05%2f24%2fusing-the-dynamic-keyword-in-c-to-improve-object-orientation.aspx" class="img-fluid" alt="kick it on DotNetKicks.com" /></p>


<div id="disqus_thread"></div>  
<!--
    'Using-the-dynamic-Keyword-in-C%23-to-Improve-Object-Orientation'
    'Using the dynamic Keyword in C# to Improve Object-Orientation'
    'http://blog.peterritchie.com/posts/Using-the-dynamic-Keyword-in-C%23-to-Improve-Object-Orientation'
-->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */

    var fromJekyllDate = new Date('Wed Feb 01 2022');
    var publishedDate = new Date('5/24/10');
    console.info('Using-the-dynamic-Keyword-in-C%23-to-Improve-Object-Orientation');

    var disqus_identifier = '';
    var disqus_shortname = 'peterritchiesblog'; // required: replace example with your forum shortname
    var disqus_title = 'Using the dynamic Keyword in C# to Improve Object-Orientation';
    var disqus_url = 'http://blog.peterritchie.com/posts/Using-the-dynamic-Keyword-in-C%23-to-Improve-Object-Orientation';

    if(publishedDate < fromJekyllDate)
    {
        disqus_url = disqus_url.replace('/posts', '');
        disqus_url = disqus_url + '/';
    }
    else
    {
        //var disqus_identifier = 'Using-the-dynamic-Keyword-in-C%23-to-Improve-Object-Orientation';
    }
    console.info(disqus_identifier);

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                                </div>
                        </div>
                </div>
                
                <hr>
                
                <!-- Footer -->
                <footer>
                        <div class="container">
        <div class="row">
                <div class="col-md-12 text-center">
                    <p class="copyright text-muted">
                        Copyright © Peter Ritchie&#x27;s Blog 2026
                        <br />
                            <a href="/feed.xml"><i class="fa fa-rss"></i> RSS Feed</a>
                        |
                            <a href="/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
                        <br />
                        <strong><a href="https://wyam.io">Generated by "Wyam"</a></strong>
                        <br/>
                        <a rel="me" href="https://mastodon.social/@peterritchie">Mastodon.social</a>&nbsp;|&nbsp;<a rel="me" href="https://fosstodon.org/@peterritchie">fosstodon.org</a>&nbsp;|&nbsp;<a rel="me" href="https://twitter.com/peterritchie">Twitter</a>&nbsp;|&nbsp;<a rel="me" href="https://www.linkedin.com/in/peteraritchie/">LinkedIn</a>&nbsp;|&nbsp;<a rel="me" href="https://bsky.app/profile/peterritchie.com">Bluesky</a>
                    </p>
                </div>
        </div>
</div>
                </footer> 

                <script src="/assets/js/jquery.min.js"></script>
                <script src="/assets/js/bootstrap.min.js"></script>     
                <script src="/assets/js/highlight.pack.js"></script>   
                <script src="/assets/js/clean-blog.js"></script>
                <script src="/assets/js/d3.v3.min.js"></script>
                <script src="/assets/js/trianglify.min.js"></script>
                <script src="/assets/js/Please-compressed.js"></script>
                <script src="/assets/js/background-check.min.js"></script>

                <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
                <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
                <!--[if lt IE 9]>
                        <script src="/assets/js/html5shiv.js"></script>
                        <script src="/assets/js/respond.min.js"></script>
                <![endif]-->
                
                
                <script>hljs.initHighlightingOnLoad();</script>

                        <script type="text/javascript">                
                                // Header background                        
                                var colors = Please.make_color({
                                        colors_returned: 3,
                                        saturation: .6
                                });
                                var t = new Trianglify({
                                        x_gradient: colors,
                                        y_gradient: ["#FFFFFF"]
                                });
                                var header = document.getElementById("intro-header");
                                var pattern = t.generate(header.clientWidth, header.clientHeight);
                                header.setAttribute('style', 'background-image: ' + pattern.dataUrl);                        
                        </script>

                <script>
                        BackgroundCheck.init({
                                targets: '.intro-header,.navbar',
                                images: '.intro-header'
                        });
                </script>
        </body>
</html>

