
<!DOCTYPE html>
<html lang="en">
        <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>

        <title>Peter Ritchie&#x27;s Blog - Modify VS 2010 Template to Reference System.Configuration</title>
        <meta name="description" content="Peter Ritchie" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">        

        <link type="application/rss+xml" rel="alternate" title="Peter Ritchie&#x27;s Blog" href="/feed.xml" />
                <link type="application/atom+xml" rel="alternate" title="Peter Ritchie&#x27;s Blog" href="/feed.atom" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">

        <link href="/assets/css/bootstrap.min.css" rel="stylesheet" />
        <link href="/assets/css/highlight.css" rel="stylesheet">
        <link href="/assets/css/clean-blog.css" rel="stylesheet" />
        <link href="/assets/css/master.css" rel="stylesheet" />
        <link href="/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
        <link href="/assets/css/override.css" rel="stylesheet" />


        <meta name="application-name" content="Peter Ritchie&#x27;s Blog" />
        <meta name="msapplication-tooltip" content="Peter Ritchie&#x27;s Blog" />
        <meta name="msapplication-starturl" content="/" />

        <meta property="og:title" content="Peter Ritchie&#x27;s Blog - Modify VS 2010 Template to Reference System.Configuration" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="http://blog.peterritchie.com/posts/Modify-VS-2010-Template-to-Reference-System.Configuration" />
        <!-- TODO: More social graph meta tags -->

        


        </head>
        <body>
                
                <!-- Navigation -->
                <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
                        <div class="container-fluid">
                                <!-- Brand and toggle get grouped for better mobile display -->
                                <div class="navbar-header page-scroll">
                                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
                                        <span class="sr-only">Toggle navigation</span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        </button>
                                        <a class="navbar-brand" href="/">Peter Ritchie&#x27;s Blog</a>
                                </div>
                        
                                <!-- Collect the nav links, forms, and other content for toggling -->
                                <div class="collapse navbar-collapse" id="navbar-collapse">
                                        <ul class="nav navbar-nav navbar-right">
                                                        <li><a href="/posts">Archive</a></li>
        <li><a href="/tags">Tags</a></li>
        <li><a href="/about">About</a></li>
 
                                        </ul>
                                </div>
                                <!-- /.navbar-collapse -->
                        </div>
                        <!-- /.container -->
                </nav>
                
                <!-- Page Header -->
                <header class="intro-header" id="intro-header">
                        <div class="container">
                                <div class="row">
                                        <div class="col-md-12">

    
<div class="post-heading">
    <h1>Modify VS 2010 Template to Reference System.Configuration</h1>
    <div class="meta">        
Published on Tuesday, April 20, 2010<br>    </div>
        <div class="tags">
                    <a role="button" href="/tags/NET-Development" class="btn btn-default btn-xs">.NET Development</a>
                    <a role="button" href="/tags/April-2010" class="btn btn-default btn-xs">April 2010</a>
                    <a role="button" href="/tags/C%23" class="btn btn-default btn-xs">C#</a>
                    <a role="button" href="/tags/DevCenterPost" class="btn btn-default btn-xs">DevCenterPost</a>
                    <a role="button" href="/tags/Software-Development" class="btn btn-default btn-xs">Software Development</a>
                    <a role="button" href="/tags/Visual-Studio-2010" class="btn btn-default btn-xs">Visual Studio 2010</a>
                    <a role="button" href="/tags/WinForms" class="btn btn-default btn-xs">WinForms</a>
                    <a role="button" href="/tags/msmvps" class="btn btn-default btn-xs">msmvps</a>
        </div>     
</div>
                                        </div>
                                </div>
                        </div>
                </header>
                
                <!-- Main Content -->
                <div class="container">
                        <div class="row">
                                <div id="content" class="col-md-12">
                                        

<p><a href="http://blogs.msmvps.com/peterritchie/2010/04/20/modify-vs-2010-template-to-reference-system-configuration/" title="Permalink to Modify VS 2010 Template to Reference System.Configuration">Source</a></p>
<h1 id="modify-vs-2010-template-to-reference-system.configuration">Modify VS 2010 Template to Reference System.Configuration</h1>
<p>Almost every project I create in Visual Studio, I invariably have to add System.Configuration to the references for that project. As soon as I want to do much with app.config, I need to use something in System.Configuration. Well, rather than continue to add that reference to future projects, I've decided to change the project template so I don't have to. The following is a description of how to do that.</p>
<p>The project templates are located at <strong>C:Program FilesMicrosoft Visual Studio 10.0Common7ideProjectTemplates</strong> (replace &quot;Program Files&quot; with &quot;Program Files (x86)&quot; if you're using a 64-bit version of Windows). For this example I'm going to change the C# Windows Forms Application template. Each language has their own directory and each template is localized to multiple languages. For me, my locale code is 1033, so the Windows Forms Application template is located in <strong>CSharpWindows1033WindowsApplication.zip</strong>. To modify anything in the template we need to extract the contents. This is best done by copying the file to your Documents directory then extracting the contents (in Windows 7, you'll get lots of UAC prompts when you start editing files in Program Files, so this makes life a little easier). Go ahead and make a backup of this file now.</p>
<p>For what we want to do, we want to <em>edit the <strong>windowsapplication.csproj</strong></em> file, so open that in notepad. We want to change references, so we need to edit the Reference elements, so search for &quot;&lt;Reference&quot;. This will put you at a section of the file that looks like this:<br />
<ItemGroup><br />
<Reference Include="System"/><br />
<span class="math">\(if\)</span> (<span class="math">\(targetframeworkversion\)</span> &gt;= 3.5)<br />
<Reference Include="System.Core"/><br />
<Reference Include="System.Xml.Linq"/><br />
<Reference Include="System.Data.DataSetExtensions"/><br />
<span class="math">\(endif\)</span><br />
<span class="math">\(if\)</span> (<span class="math">\(targetframeworkversion\)</span> &gt;= 4.0)<br />
<Reference Include="Microsoft.CSharp"/><br />
<span class="math">\(endif\)</span><br />
<Reference Include="System.Data"/><br />
<Reference Include="System.Deployment"/><br />
<Reference Include="System.Drawing"/><br />
<Reference Include="System.Windows.Forms"/><br />
<Reference Include="System.Xml"/><br />
</ItemGroup></p>
<p>We want to add a reference to System.Configuration, so go ahead and add '<Reference Include="System.Data"/>' as the first item in the ItemGroup. We also want to remove references to System.Xml and System.Xml.Linq. Heck, while we're at it, let's also get rid of other references I don't use that much: System.Data.DataSetExtensions and Microsoft.CSharp. This leaves us with something like:<br />
<ItemGroup><br />
<Reference Include="System.Configuration"/><br />
<Reference Include="System"/><br />
<span class="math">\(if\)</span> (<span class="math">\(targetframeworkversion\)</span> &gt;= 3.5)<br />
<Reference Include="System.Core"/><br />
<span class="math">\(endif\)</span><br />
<Reference Include="System.Data"/><br />
<Reference Include="System.Deployment"/><br />
<Reference Include="System.Drawing"/><br />
<Reference Include="System.Windows.Forms"/><br />
</ItemGroup></p>
<p>Now, save the file.</p>
<p>If you're removing other references (like System.Core) you'll have to also edit some of the .cs files in the template to make sure they're not referencing namespaces within the removed references (like System.Linq in form1.cs). If you need to do that, go ahead and do that as well.</p>
<p>Now, we need to take all those files and <em>re-zip them back into a file named WindowsApplication.zip</em>. Once we do that we can _copy that back into <strong>c:Program FilesMicrosoft Visual Studio 10.0Common7ideProjectTemplatesCSharpWindows1033</strong> _directory. Visual Studio also caches the files in the templates. There's a way to get VS to reconstruct that cache, but, it's easier to simply <em>copy the files from the WindowsApplication.zip file into the cache directory located at <strong>C:Program Files (x86)Microsoft Visual Studio 10.0Common7IDEProjectTemplatesCacheCSharpWindows1033WindowsApplication.zip</strong></em>. This is actually a directory, not a ZIP file. Go ahead and copy all the files (or at least the ones you've modified to this directory.</p>
<p>And we're done. Now, <em>restart VS</em>, and create a new Windows Forms Application project. You'll see that References in the Solution Explorer look something like this:</p>
<p><img src="http://msmvps.com/cfs-file.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/peterritchie.metablogapi/0842.projectreferences_5F00_thumb_5F00_5862FABB.png" class="img-fluid" alt="project references" title="project references" /></p>
<p>No more System.Xml.*, Microsoft.CSharp, System.Data.DataSetExtensions and System.Configuration is now there.</p>
<p>Enjoy!</p>


<div id="disqus_thread"></div>  
<!--
    'Modify-VS-2010-Template-to-Reference-System.Configuration'
    'Modify VS 2010 Template to Reference System.Configuration'
    'http://blog.peterritchie.com/posts/Modify-VS-2010-Template-to-Reference-System.Configuration'
-->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */

    var fromJekyllDate = new Date('Wed Feb 01 2022');
    var publishedDate = new Date('4/20/10');
    console.info('Modify-VS-2010-Template-to-Reference-System.Configuration');

    var disqus_identifier = '';
    var disqus_shortname = 'peterritchiesblog'; // required: replace example with your forum shortname
    var disqus_title = 'Modify VS 2010 Template to Reference System.Configuration';
    var disqus_url = 'http://blog.peterritchie.com/posts/Modify-VS-2010-Template-to-Reference-System.Configuration';

    if(publishedDate < fromJekyllDate)
    {
        disqus_url = disqus_url.replace('/posts', '');
        disqus_url = disqus_url + '/';
    }
    else
    {
        //var disqus_identifier = 'Modify-VS-2010-Template-to-Reference-System.Configuration';
    }
    console.info(disqus_identifier);

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                                </div>
                        </div>
                </div>
                
                <hr>
                
                <!-- Footer -->
                <footer>
                        <div class="container">
        <div class="row">
                <div class="col-md-12 text-center">
                    <p class="copyright text-muted">
                        Copyright © Peter Ritchie&#x27;s Blog 2025
                        <br />
                            <a href="/feed.xml"><i class="fa fa-rss"></i> RSS Feed</a>
                        |
                            <a href="/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
                        <br />
                        <strong><a href="https://wyam.io">Generated by "Wyam"</a></strong>
                        <br/>
                        <a rel="me" href="https://mastodon.social/@peterritchie">Mastodon.social</a>&nbsp;|&nbsp;<a rel="me" href="https://fosstodon.org/@peterritchie">fosstodon.org</a>&nbsp;|&nbsp;<a rel="me" href="https://twitter.com/peterritchie">Twitter</a>&nbsp;|&nbsp;<a rel="me" href="https://www.linkedin.com/in/peteraritchie/">LinkedIn</a>&nbsp;|&nbsp;<a rel="me" href="https://bsky.app/profile/peterritchie.com">Bluesky</a>
                    </p>
                </div>
        </div>
</div>
                </footer> 

                <script src="/assets/js/jquery.min.js"></script>
                <script src="/assets/js/bootstrap.min.js"></script>     
                <script src="/assets/js/highlight.pack.js"></script>   
                <script src="/assets/js/clean-blog.js"></script>
                <script src="/assets/js/d3.v3.min.js"></script>
                <script src="/assets/js/trianglify.min.js"></script>
                <script src="/assets/js/Please-compressed.js"></script>
                <script src="/assets/js/background-check.min.js"></script>

                <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
                <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
                <!--[if lt IE 9]>
                        <script src="/assets/js/html5shiv.js"></script>
                        <script src="/assets/js/respond.min.js"></script>
                <![endif]-->
                
                
                <script>hljs.initHighlightingOnLoad();</script>

                        <script type="text/javascript">                
                                // Header background                        
                                var colors = Please.make_color({
                                        colors_returned: 3,
                                        saturation: .6
                                });
                                var t = new Trianglify({
                                        x_gradient: colors,
                                        y_gradient: ["#FFFFFF"]
                                });
                                var header = document.getElementById("intro-header");
                                var pattern = t.generate(header.clientWidth, header.clientHeight);
                                header.setAttribute('style', 'background-image: ' + pattern.dataUrl);                        
                        </script>

                <script>
                        BackgroundCheck.init({
                                targets: '.intro-header,.navbar',
                                images: '.intro-header'
                        });
                </script>
        </body>
</html>

