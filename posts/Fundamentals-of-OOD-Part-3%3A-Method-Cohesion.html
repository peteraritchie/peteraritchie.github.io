
<!DOCTYPE html>
<html lang="en">
        <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>

        <title>Peter Ritchie&#x27;s Blog - Fundamentals of OOD Part 3: Method Cohesion</title>
        <meta name="description" content="Peter Ritchie" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">        

        <link type="application/rss+xml" rel="alternate" title="Peter Ritchie&#x27;s Blog" href="/feed.xml" />
                <link type="application/atom+xml" rel="alternate" title="Peter Ritchie&#x27;s Blog" href="/feed.atom" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">

        <link href="/assets/css/bootstrap.min.css" rel="stylesheet" />
        <link href="/assets/css/highlight.css" rel="stylesheet">
        <link href="/assets/css/clean-blog.css" rel="stylesheet" />
        <link href="/assets/css/master.css" rel="stylesheet" />
        <link href="/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
        <link href="/assets/css/override.css" rel="stylesheet" />


        <meta name="application-name" content="Peter Ritchie&#x27;s Blog" />
        <meta name="msapplication-tooltip" content="Peter Ritchie&#x27;s Blog" />
        <meta name="msapplication-starturl" content="/" />

        <meta property="og:title" content="Peter Ritchie&#x27;s Blog - Fundamentals of OOD Part 3: Method Cohesion" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="http://blog.peterritchie.com/posts/Fundamentals-of-OOD-Part-3%3A-Method-Cohesion" />
        <!-- TODO: More social graph meta tags -->

        


        </head>
        <body>
                
                <!-- Navigation -->
                <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
                        <div class="container-fluid">
                                <!-- Brand and toggle get grouped for better mobile display -->
                                <div class="navbar-header page-scroll">
                                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
                                        <span class="sr-only">Toggle navigation</span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        </button>
                                        <a class="navbar-brand" href="/">Peter Ritchie&#x27;s Blog</a>
                                </div>
                        
                                <!-- Collect the nav links, forms, and other content for toggling -->
                                <div class="collapse navbar-collapse" id="navbar-collapse">
                                        <ul class="nav navbar-nav navbar-right">
                                                        <li><a href="/posts">Archive</a></li>
        <li><a href="/tags">Tags</a></li>
        <li><a href="/about">About</a></li>
 
                                        </ul>
                                </div>
                                <!-- /.navbar-collapse -->
                        </div>
                        <!-- /.container -->
                </nav>
                
                <!-- Page Header -->
                <header class="intro-header" id="intro-header">
                        <div class="container">
                                <div class="row">
                                        <div class="col-md-12">

    
<div class="post-heading">
    <h1>Fundamentals of OOD Part 3: Method Cohesion</h1>
    <div class="meta">        
Published on Tuesday, June 10, 2008<br>    </div>
        <div class="tags">
                    <a role="button" href="/tags/C%23" class="btn btn-default btn-xs">C#</a>
                    <a role="button" href="/tags/Design/Coding-Guidance" class="btn btn-default btn-xs">Design/Coding Guidance</a>
                    <a role="button" href="/tags/DevCenterPost" class="btn btn-default btn-xs">DevCenterPost</a>
                    <a role="button" href="/tags/June-2008" class="btn btn-default btn-xs">June 2008</a>
                    <a role="button" href="/tags/OOD" class="btn btn-default btn-xs">OOD</a>
                    <a role="button" href="/tags/Software-Development" class="btn btn-default btn-xs">Software Development</a>
                    <a role="button" href="/tags/msmvps" class="btn btn-default btn-xs">msmvps</a>
        </div>     
</div>
                                        </div>
                                </div>
                        </div>
                </header>
                
                <!-- Main Content -->
                <div class="container">
                        <div class="row">
                                <div id="content" class="col-md-12">
                                        

<p><a href="http://blogs.msmvps.com/peterritchie/2008/06/10/fundamentals-of-ood-part-3-method-cohesion/" title="Permalink to Fundamentals of OOD Part 3: Method Cohesion">Source</a></p>
<h1 id="fundamentals-of-ood-part-3-method-cohesion">Fundamentals of OOD Part 3: Method Cohesion</h1>
<p>Single Responsibility Principle (SRP) helps us write more cohesive types and methods. Cohesion is the relatedness of the members of a type to each other and the relatedness parts of a method's code to other parts.</p>
<p><strong>Method cohesion</strong><br />
Often times a method is not very cohesive, meaning the code that it executes relates to more than one thing. This can often be seen with a method that contains a large switch statement. For any invocation of the method only one case statement may be executed; meaning that blocks of code within the method don't relate to all the other blocks. Switch statements are often an indication that the design should be changed to be more polymorphic or introduce a pattern like the Strategy or Template Method patterns. Likely a concept of the design is implicit instead of explicit (at least no more explicit than an enum). For example:</p>
<p>public class Set {</p>
<p>public enum Operation {</p>
<p>Unknown,</p>
<p>Union,</p>
<p>Intersection,</p>
<p>RelativeComplement,</p>
<p>And,</p>
<p>Conjunction = And</p>
<p>}</p>
<p>public static IList<int> PerformOperation(IList<int> one, IList<int> two, Operation operation) {</p>
<p>List<int> result = new List<int>();</p>
<p>switch (operation) {</p>
<pre><code>case Operation.Union:

 result.AddRange(one);

 result.AddRange(two);

 break;

case Operation.Intersection:

 foreach (int x in one) {

  if (two.Contains(x)) {

   result.Add(x);

  }

 }

 break;

case Operation.RelativeComplement:

 foreach (int x in one) {

  if (!two.Contains(x)) {

   result.Add(x);

  }

 }

 break;

case Operation.And:

 foreach (int x in one) {

  if (two.Contains(x)) {

   result.Add(x);

  }

 }

 break;

default:

 throw new ArgumentOutOfRangeException(&quot;operation&quot;);
</code></pre>
<p>}</p>
<p>return result;</p>
<p>}</p>
<p>}</p>
<p>This code works; but it's far from cohesive. There are many combinations of execution paths this method can take, and each path is unrelated to the other paths. For example, the Union case has no relation to any of the other cases. Methods like this are also hard to maintain and prone to errors. Obviously if another member were added to Operation PerformOperation would have to change–making PerformOperation tightly coupled to Operation–not very object oriented.</p>
<p>This can be made more object-oriented by through Dependency Inversion and the Strategy Pattern:</p>
<p>public class Set2 {</p>
<p>public abstract class Operation {</p>
<p>public abstract IList<int> Execute(IList<int> left, IList<int> right);</p>
<p>}</p>
<p>public class UnionOperation : Operation {</p>
<p>public override IList<int> Execute(IList<int> left, IList<int> right) {</p>
<pre><code>List&lt;int&gt; result = new List&lt;int&gt;();

result.AddRange(left);

result.AddRange(right);

return result;
</code></pre>
<p>}</p>
<p>}</p>
<p>public class IntersectionOperation : Operation {</p>
<p>public override IList<int> Execute(IList<int> left, IList<int> right) {</p>
<pre><code>List&lt;int&gt; result = new List&lt;int&gt;();

foreach (int x in left) {

 if (right.Contains(x)) {

  result.Add(x);

 }

}

return result;
</code></pre>
<p>}</p>
<p>}</p>
<p>public class RelativeComplementOperation : Operation {</p>
<p>public override IList<int> Execute(IList<int> left, IList<int> right) {</p>
<pre><code>List&lt;int&gt; result = new List&lt;int&gt;();

foreach (int x in left) {

 if (!right.Contains(x)) {

  result.Add(x);

 }

}

return result;
</code></pre>
<p>}</p>
<p>}</p>
<p>public class AndOperation : Operation {</p>
<p>public override IList<int> Execute(IList<int> left, IList<int> right) {</p>
<pre><code>List&lt;int&gt; result = new List&lt;int&gt;();

foreach (int x in left) {

 if (right.Contains(x)) {

  result.Add(x);

 }

}

return result;
</code></pre>
<p>}</p>
<p>}</p>
<p>public static IList<int> PerformOperation(IList<int> left, IList<int> right, Operation operation) {</p>
<p>return operation.Execute(left, right);</p>
<p>}</p>
<p>}</p>
<p>Now eachoperation is encapsulated, explicit, PerformOperationneednot change as new strategies are added, and we've completely avoided the InvalidOperationException.</p>
<p><img src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=http%3a%2f%2fmsmvps.com%2fblogs%2fpeterritchie%2farchive%2f2008%2f06%2f10%2ffundamentals-of-ood-part-3-method-cohesion.aspx" class="img-fluid" alt="kick it on DotNetKicks.com" /></p>


<div id="disqus_thread"></div>  
<!--
    'Fundamentals-of-OOD-Part-3%3A-Method-Cohesion'
    'Fundamentals of OOD Part 3: Method Cohesion'
    'http://blog.peterritchie.com/posts/Fundamentals-of-OOD-Part-3%3A-Method-Cohesion'
-->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */

    var fromJekyllDate = new Date('Wed Feb 01 2022');
    var publishedDate = new Date('6/10/08');
    console.info('Fundamentals-of-OOD-Part-3%3A-Method-Cohesion');

    var disqus_identifier = '';
    var disqus_shortname = 'peterritchiesblog'; // required: replace example with your forum shortname
    var disqus_title = 'Fundamentals of OOD Part 3: Method Cohesion';
    var disqus_url = 'http://blog.peterritchie.com/posts/Fundamentals-of-OOD-Part-3%3A-Method-Cohesion';

    if(publishedDate < fromJekyllDate)
    {
        disqus_url = disqus_url.replace('/posts', '');
        disqus_url = disqus_url + '/';
    }
    else
    {
        //var disqus_identifier = 'Fundamentals-of-OOD-Part-3%3A-Method-Cohesion';
    }
    console.info(disqus_identifier);

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                                </div>
                        </div>
                </div>
                
                <hr>
                
                <!-- Footer -->
                <footer>
                        <div class="container">
        <div class="row">
                <div class="col-md-12 text-center">
                    <p class="copyright text-muted">
                        Copyright © Peter Ritchie&#x27;s Blog 2025
                        <br />
                            <a href="/feed.xml"><i class="fa fa-rss"></i> RSS Feed</a>
                        |
                            <a href="/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
                        <br />
                        <strong><a href="https://wyam.io">Generated by "Wyam"</a></strong>
                        <br/>
                        <a rel="me" href="https://dotnet.social/@peterritchie">dotnet.social</a>&nbsp;|&nbsp;<a rel="me" href="https://mastodon.social/@peterritchie">Mastodon.social</a>&nbsp;|&nbsp;<a rel="me" href="https://fosstodon.org/@peterritchie">fosstodon.org</a>&nbsp;|&nbsp;<a rel="me" href="https://twitter.com/peterritchie">Twitter</a>&nbsp;|&nbsp;<a rel="me" href="https://www.linkedin.com/in/peteraritchie/">LinkedIn</a>
                    </p>
                </div>
        </div>
</div>
                </footer> 

                <script src="/assets/js/jquery.min.js"></script>
                <script src="/assets/js/bootstrap.min.js"></script>     
                <script src="/assets/js/highlight.pack.js"></script>   
                <script src="/assets/js/clean-blog.js"></script>
                <script src="/assets/js/d3.v3.min.js"></script>
                <script src="/assets/js/trianglify.min.js"></script>
                <script src="/assets/js/Please-compressed.js"></script>
                <script src="/assets/js/background-check.min.js"></script>

                <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
                <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
                <!--[if lt IE 9]>
                        <script src="/assets/js/html5shiv.js"></script>
                        <script src="/assets/js/respond.min.js"></script>
                <![endif]-->
                
                
                <script>hljs.initHighlightingOnLoad();</script>

                        <script type="text/javascript">                
                                // Header background                        
                                var colors = Please.make_color({
                                        colors_returned: 3,
                                        saturation: .6
                                });
                                var t = new Trianglify({
                                        x_gradient: colors,
                                        y_gradient: ["#FFFFFF"]
                                });
                                var header = document.getElementById("intro-header");
                                var pattern = t.generate(header.clientWidth, header.clientHeight);
                                header.setAttribute('style', 'background-image: ' + pattern.dataUrl);                        
                        </script>

                <script>
                        BackgroundCheck.init({
                                targets: '.intro-header,.navbar',
                                images: '.intro-header'
                        });
                </script>
        </body>
</html>

